import streamlit as st\nimport numpy as np\nimport pandas as pd\nimport plotly.graph_objs as go\nfrom keras.models import Sequential\nfrom keras.layers import Dense, LSTM, Dropout\nfrom sklearn.preprocessing import MinMaxScaler\nimport yfinance as yf\n\n# Load data\n@st.cache\ndef load_data(ticker):\n    data = yf.download(ticker)\n    return data\n\n# Prepare the dataset for LSTM\ndef prepare_data(data):\n    scaler = MinMaxScaler(feature_range=(0, 1))\n    scaled_data = scaler.fit_transform(data['Close'].values.reshape(-1,1))\n    train_size = int(len(scaled_data) * 0.8)\n    train_data = scaled_data[0:train_size]\n    x_train, y_train = [], []\n    for i in range(60, len(train_data)):\n        x_train.append(train_data[i-60:i, 0])\n        y_train.append(train_data[i, 0])\n    return np.array(x_train), np.array(y_train), scaler\n\n# Build the LSTM model\ndef build_model():\n    model = Sequential()\n    model.add(LSTM(units=50, return_sequences=True, input_shape=(60, 1)))\n    model.add(Dropout(0.2))\n    model.add(LSTM(units=50, return_sequences=False))\n    model.add(Dropout(0.2))\n    model.add(Dense(units=1))\n    model.compile(optimizer='adam', loss='mean_squared_error')\n    return model\n\n# Main function to run the Streamlit app\ndef main():\n    st.title('Crypto Price Predictor')\n\n    ticker = st.text_input('Enter Cryptocurrency Ticker (e.g. BTC-USD)', 'BTC-USD')\n    if st.button('Predict'):\n        data = load_data(ticker)\n        x_train, y_train, scaler = prepare_data(data)\n        model = build_model()\n        model.fit(x_train.reshape(x_train.shape[0], x_train.shape[1], 1), y_train, epochs=50, batch_size=32)\n        st.success('Model trained!')\n\n        # Making predictions\n        test_data = scaled_data[train_size - 60:]\n        x_test = []\n        for i in range(60, len(test_data)):\n            x_test.append(test_data[i-60:i, 0])\n        x_test = np.array(x_test)\n        x_test = x_test.reshape(x_test.shape[0], x_test.shape[1], 1)\n        predictions = model.predict(x_test)\n        predictions = scaler.inverse_transform(predictions)\n\n        # Visualizing the results with Plotly\n        st.subheader('Predicted vs Actual Prices')\n        fig = go.Figure()\n        fig.add_trace(go.Scatter(x=data.index[train_size:], y=predictions.flatten(), name='Predicted', mode='lines'))\n        fig.add_trace(go.Scatter(x=data.index, y=data['Close'], name='Actual', mode='lines'))\n        st.plotly_chart(fig)\n\nif __name__ == '__main__':\n    main()